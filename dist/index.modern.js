import{useCallback as e,useRef as n,useState as t,useEffect as r,useLayoutEffect as o}from"react";import i from"resize-observer-polyfill";function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}const f={debug:10,info:20,warn:30,error:40,none:100},a="undefined"!=typeof window&&window.document&&window.document.createElement?o:r;export default({logLevel:o="info",maxFontSize:u=100,minFontSize:l=20,onFinish:s,onStart:z,resolution:S=5}={})=>{const d=f[o],m=e(()=>({calcKey:0,fontSize:u,fontSizePrev:l,fontSizeMax:u,fontSizeMin:l}),[u,l]),w=n(null),h=n(),y=n(!1),[M,v]=t(m),{calcKey:p,fontSize:x,fontSizeMax:b,fontSizeMin:g,fontSizePrev:K}=M;let F=null;const[P]=t(()=>new i(()=>{F=window.requestAnimationFrame(()=>{y.current||(z&&z(),y.current=!0,v(c({},m(),{calcKey:p+1})))})}));r(()=>(w.current&&P.observe(w.current),()=>{F&&window.cancelAnimationFrame(F),P.disconnect()}),[F,P]);const O=w.current&&w.current.innerHTML;r(()=>{0===p||y.current||(O!==h.current&&(z&&z(),v(c({},m(),{calcKey:p+1}))),h.current=O)},[p,m,O,z]),a(()=>{if(0===p)return;const e=Math.abs(x-K)<=S,n=!!w.current&&(w.current.scrollHeight>w.current.offsetHeight||w.current.scrollWidth>w.current.offsetWidth),t=x>K;if(e)return void(n&&x===K?(y.current=!1,d<=f.info&&console.info(`[use-fit-text] reached \`minFontSize = ${l}\` without fitting text`)):n?v({fontSize:t?K:g,fontSizeMax:b,fontSizeMin:g,fontSizePrev:K,calcKey:p}):(y.current=!1,s&&s(x)));let r,o=b,i=g;n?(r=t?K-x:g-x,o=Math.min(b,x)):(r=t?b-x:K-x,i=Math.max(g,x)),v({calcKey:p,fontSize:x+r/2,fontSizeMax:o,fontSizeMin:i,fontSizePrev:x})},[p,x,b,g,K,s,w,S]);const j=e(()=>{v(c({},m(),{calcKey:p+1}))},[p,m]);return{fontSize:x+"%",ref:w,forceRefit:j}};
//# sourceMappingURL=index.modern.js.map
